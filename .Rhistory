nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
table(id)
#plot 4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
sccs<-scc[id,1]
class(sccs)
sccs
#plot 4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
sccs<-scc[id,1]
sub_nei<-group_by(filter(nei,SCC %in% sccs),year)
summ_sub_nei<-summarise(sub_nei,emissions=sum(Emissions))
ggplot(summ_sub_nei,aes(year,Emissions))+geom_bar(stat="identity")
#plot 4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
sccs<-scc[id,1]
sub_nei<-group_by(filter(nei,SCC %in% sccs),year)
summ_sub_nei<-summarise(sub_nei,emissions=sum(Emissions))
ggplot(summ_sub_nei,aes(year,emissions))+geom_bar(stat="identity")
#plot 4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
sccs<-scc[id,1]
sub_nei<-group_by(filter(nei,SCC %in% sccs),year)
summ_sub_nei<-summarise(sub_nei,emissions=sum(Emissions))
ggplot(summ_sub_nei,aes(year,emissions))+geom_bar(stat="identity")+labs(title="emissions of coal
combustion")
#plot 4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
sccs<-scc[id,1]
sub_nei<-group_by(filter(nei,SCC %in% sccs),year)
summ_sub_nei<-summarise(sub_nei,emissions=sum(Emissions)/1000)
ggplot(summ_sub_nei,aes(year,emissions))+geom_bar(stat="identity")+labs(title="emissions of coal combustion")+
labs(y="emissions in kilo tons")
#plot 4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
sccs<-scc[id,1]
sub_nei<-group_by(filter(nei,SCC %in% sccs),year)
summ_sub_nei<-summarise(sub_nei,emissions=sum(Emissions)/1000)
ggplot(summ_sub_nei,aes(year,emissions))+geom_bar(stat="identity",aes(fill=year))+labs(title="emissions of coal combustion")+
labs(y="emissions in kilo tons")
#plot 4
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("^Fuel Comb.*Coal",scc[,4])
sccs<-scc[id,1]
sub_nei<-group_by(filter(nei,SCC %in% sccs),year)
summ_sub_nei<-summarise(sub_nei,emissions=sum(Emissions)/1000)
ggplot(summ_sub_nei,aes(year,emissions))+geom_bar(stat="identity",aes(fill=year))+labs(title="emissions of coal combustion")+
labs(y="emissions in kilo tons")
dev.off()
table(scc[,4])
id<-grepl("On-Road",scc[,4])
table(id)
#plot4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
#subsetting baltimore data
subdata<-filter(nei,fips=="06037")
id<-grepl("On-Road",ssc[,4])
sccs<-scc[id,1]
#plot4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
#subsetting baltimore data
subdata<-filter(nei,fips=="06037")
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]
sccs
length(sccs)
#plot4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
#subsetting baltimore data
subdata<-filter(nei,fips=="06037")
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]
subdata<-group_by(filter(subdata,SCC %in% sccs),year)
summ_subdata<-summarize(subdata,emissions=sum(Emissions)/1000)
ggplot(summ_subdata,aes(year,emissions))+geom_bar(stat="identity",aes(fill=year))+labs(main="motor emission in baltimore city")+
labs(y="Emissions in kilotons")
?mains
?labs
#plot4
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
#subsetting baltimore data
subdata<-filter(nei,fips=="06037")
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]
subdata<-group_by(filter(subdata,SCC %in% sccs),year)
summ_subdata<-summarize(subdata,emissions=sum(Emissions)/1000)
ggplot(summ_subdata,aes(year,emissions))+geom_bar(stat="identity",aes(fill=year))+labs(y="Emissions in kilotons")+
labs(title="Motor emissions in baltimore city")
#plot4
library(dplyr)
library(ggplot2)
png("plot5.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
#subsetting baltimore data
subdata<-filter(nei,fips=="06037")
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]
subdata<-group_by(filter(subdata,SCC %in% sccs),year)
summ_subdata<-summarize(subdata,emissions=sum(Emissions)/1000)
ggplot(summ_subdata,aes(year,emissions))+geom_bar(stat="identity",aes(fill=year))+labs(y="Emissions in kilotons")+
labs(title="Motor emissions in baltimore city")
dev.off()
#plot 2
library(dplyr)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
png("plot2.png")
#subsetting the baltimore data
group_nei<-group_by(subset(nei,fips=="24510"),year)
total.emmisions<-summarise(group_nei,emmisions=sum(Emissions))
barplot(height=total.emmisions$emmisions,names.arg = total.emmisions$year,ylab = "
Particulate matter",xlab="year",main="Data for Baltimore city")
dev.off()
#plot 3
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
png("plot3.png")
#subsetting baltimore data
subdata<-filter(nei,fips=="24510")
group_data<-summarise(group_by(subdata,type,year),emmisions=sum(Emissions))
ggplot(group_data,aes(year,emmisions))+geom_bar(stat="identity",aes(fill=type))+facet_grid(.~type)
dev.off()
#plot4
library(dplyr)
library(ggplot2)
png("plot5.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
#subsetting baltimore data
subdata<-filter(nei,fips=="24510")
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]
subdata<-group_by(filter(subdata,SCC %in% sccs),year)
summ_subdata<-summarize(subdata,emissions=sum(Emissions)/1000)
ggplot(summ_subdata,aes(year,emissions))+geom_bar(stat="identity",aes(fill=year))+labs(y="Emissions in kilotons")+
labs(title="Motor emissions in baltimore city")
dev.off()
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
nei<-transform(nei,fips=factor(fips))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips="06037")
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
nei<-transform(nei,fips=factor(fips))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
table(subdata$fips)
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
#nei<-transform(nei,fips=factor(fips))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
table(subdata$fips)
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
nei<-transform(nei,fips=factor(fips,labels=fips))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips))
table(subdata$fips)
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips))
summ_subdata<-summarise(group_by(subdata,year,fips),emissions=sum(emissions))
ggplot(summ_data,aes(year,emissions/1000))+geom_bar(stat="identity")+facet_grid(.~fips)
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips))
summ_subdata<-summarise(group_by(subdata,year,fips),emissions=sum(emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity")+facet_grid(.~fips)
summ_subdata
#plot 6
library(dplyr)
library(ggplot2)
png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips))
subdata<-group_by(subdata,fips,year)
summ_subdata<-summarise(subdata,emissions=sum(Emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity")+facet_grid(.~fips)
#plot 6
library(dplyr)
library(ggplot2)
#png("plot4.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips))
subdata<-group_by(subdata,fips,year)
summ_subdata<-summarise(subdata,emissions=sum(Emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity")+facet_grid(.~fips)
summ_subdata
#plot 6
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips))
subdata<-group_by(subdata,fips,year)
summ_subdata<-summarise(subdata,emissions=sum(Emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity")+facet_grid(.~fips)
dev.off()
dev.cur()
#plot 6
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips))
subdata<-group_by(subdata,fips,year)
summ_subdata<-summarise(subdata,emissions=sum(Emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity")+facet_grid(.~fips)
#plot 6
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips,labels=c("los Angeles","Baltimore")))
subdata<-group_by(subdata,fips,year)
summ_subdata<-summarise(subdata,emissions=sum(Emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity")+facet_grid(.~fips)
#plot 6
library(dplyr)
library(ggplot2)
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips,labels=c("los Angeles","Baltimore")))
subdata<-group_by(subdata,fips,year)
summ_subdata<-summarise(subdata,emissions=sum(Emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity",aes(fill=fips))+facet_grid(.~fips)+
labs(y="emissions in kilo ton")
#plot 6
library(dplyr)
library(ggplot2)
png(file="plot6.png")
nei <- readRDS("nei/summarySCC_PM25.rds")
scc <- readRDS("nei/Source_Classification_Code.rds")
nei<-transform(nei,year=factor(year,labels=c(1999,2002,2005,2008)))
nei<-transform(nei,type=factor(type))
id<-grepl("On-Road",scc[,4])
sccs<-scc[id,1]#SCC for motor emissions
#subsetting baltimore and los angeles
subdata<-filter(nei,fips=="24510"|fips=="06037")
subdata<-transform(subdata,fips=factor(fips,labels=c("los Angeles","Baltimore")))
subdata<-group_by(subdata,fips,year)
summ_subdata<-summarise(subdata,emissions=sum(Emissions))
ggplot(summ_subdata,aes(year,emissions/1000))+geom_bar(stat="identity",aes(fill=fips))+facet_grid(.~fips)+
labs(y="emissions in kilo ton")
dev.off()
install.packages("Kernlab")
class(airquality)
install.packages(â€˜kernlabâ€™)
install.packages("kernlab")
library(Kernlab)
library(kernlab)
data(spam)
dim(spam)
str(spam[,1:15])
names(spam)
table(spam$type)
?glm
?reformulate
library(datasets)
data(airquality)
summary(airquality)
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
group_data<-group_by(data,date)
summ_data<-summarize(group_data,steps=sum(steps,na.rm=TRUE))
hist(summ_data$steps,col="blue",xlab="Number of steps",main="Histogram of total number of steps")
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
png("plot1.png")
group_data<-group_by(data,date)
summ_data<-summarize(group_data,steps=sum(steps,na.rm=TRUE))
hist(summ_data$steps,col="blue",xlab="Number of steps",main="Histogram of total number of steps")
dev.off()
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
group_data<-group_by(data,interval)
summ_data<-summarize(group_data,steps=mean(steps,na.rm=TRUE))
with(summ_data,plot(interval,steps,type="l",xlab="Five minute intervals",main="Time series plot of the average number of steps taken"))
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
png("plot2.png")
group_data<-group_by(data,interval)
summ_data<-summarize(group_data,steps=mean(steps,na.rm=TRUE))
with(summ_data,plot(interval,steps,type="l",xlab="Five minute intervals",main="Time series plot of the average number of steps taken"))
dev.off()
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
group_data<-group_by(data,date)
summ_data<-summarize(group_data,steps=sum(steps,na.rm = TRUE))
hist(summ_data$steps,xlab="Number of steps",main="Total number of steps",col="gray")
mtext("The missing values have been imputed with the mean",outer=FALSE)
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
png("plot3.png")
group_data<-group_by(data,date)
summ_data<-summarize(group_data,steps=sum(steps,na.rm = TRUE))
hist(summ_data$steps,xlab="Number of steps",main="Total number of steps",col="gray")
mtext("The missing values have been imputed with the mean",outer=FALSE)
dev.off()
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
data<-transform(data,date=as.Date(date))
weekend<-c("Saturday","Sunday")
data$day_type<-ifelse(weekdays(data$date) %in% weekend,"weekend","weekday")
group_data<-group_by(data,day_type,interval)
summ_data<-summarize(group_data,steps=mean(steps,na.rm=TRUE))
ggplot(summ_data,aes(interval,steps))+geom_line()+facet_grid(.~day_type)
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\hp pc\\RepData_PeerAssessment1")
data=read.csv("activity/activity.csv")
png("plot4.png")
data<-transform(data,date=as.Date(date))
weekend<-c("Saturday","Sunday")
data$day_type<-ifelse(weekdays(data$date) %in% weekend,"weekend","weekday")
group_data<-group_by(data,day_type,interval)
summ_data<-summarize(group_data,steps=mean(steps,na.rm=TRUE))
ggplot(summ_data,aes(interval,steps))+geom_line()+facet_grid(.~day_type)
dev.off()
